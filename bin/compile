#!/usr/bin/env bash
# bin/compile <build-dir> <cache-dir>

# fail fast
set -e

# debug
# set -x

# clean up leaking environment
unset GIT_DIR

function indent() {
  c='s/^/       /'
  case $(uname) in
    Darwin) sed -l "$c";;
    *)      sed -u "$c";;
  esac
}

# parse and derive params
BUILD_DIR=$1
CACHE_DIR=$2
LP_DIR=`cd $(dirname $0); cd ..; pwd`

echo "Running add-files..." | indent

for CONF_FILE in $(find $LP_DIR/conf -type f -name '*.sh')
do
    echo "Sourcing file: $CONF_FILE" | indent
    . $CONF_FILE
done

echo "Finished add-files" | indent

